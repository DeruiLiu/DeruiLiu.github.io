---
layout:     post
title:      设计模式之设计原则
subtitle:   设计模式之设计原则
date:       2021-01-18
author:     DR
header-img: img/IMG_4158.jpg
catalog: true
tags:
    - design-patterns
---
# 一些经典的设计原则
<font color=red>其中包括，SOLID、KISS、YAGNI、DRY、LOD 等。</font>
SOLID原则：由5个设计原则组成的，它们分别是：单一职责原则、开闭原则、里式替换原则、接口隔离原则和依赖反转原则，依次对应SOLID中的S、O、L、I、D 这5个英文字母。
SRP单一职责原则 Single Responsibility Principle； 
KISS保持简单 Keep It Simple and Stupid； 
YAGNI不需要原则 You Ain’t Gonna Need It；
DRY不要重复原则 Don’t Repeat Yourself；
LOD迪米特法则 Law of Demeter

# 1.单一职责原则(SRP)
## 1. 如何理解单一职责原则？
一个类只负责完成一个职责或者功能。不要设计大而全的类，要设计粒度小、功能单一的类。单一职责原则是为了实现代码高内聚、低耦合，提高代码的复用性、可读性、可维护性。
## 2. 如何判断类职责是否单一？
* 类中的代码行数、函数或属性过多，会影响代码的可读性和可维护性，我们就需要考虑对类进行拆分；
* 类依赖的其他类过多，或者依赖类的其他类过多，不符合高内聚、低耦合的设计思想，我们就需要考虑对类进行拆分；
* 私有方法过多，我们就要考虑能否将私有方法独立到新的类中，设置为 public 方法，供更多的类使用，从而提高代码的复用性；
* 比较难给类起一个合适名字，很难用一个业务名词概括，或者只能用一些笼统的 Manager、Context 之类的词语来命名，这就说明类的职责定义得可能不够清晰；
* 类中大量的方法都是集中操作类中的某几个属性，比如，在 UserInfo 例子中，如果一半的方法都是在操作 address 信息，那就可以考虑将这几个属性和对应的方法拆分出来。
## 3.类的职责是否设计越单一越好？
单一职责原则通过避免设计大而全的类，避免将不相关的功能耦合在一起，来提高类的内聚性。同时，类职责单一，类依赖的和被依赖的其他类也会变少，减少了代码的耦合性，以此来实现代码的高内聚、低耦合。但是，如果拆分得过细，实际上会适得其反，反倒会降低内聚性，也会影响代码的可维护性。

# 2.开闭原则(Open closed principle)
## 1. 如何理解对扩展开放，对修改关闭？
添加一个新的功能时应该在已有代码基础上扩展代码(新增模块，类，方法等)，而非修改已有代码(修改模块，类，方法等)。
实际上开闭原则可以理解为代码的扩展性问题，判断一段代码是否易扩展的“金标准”，即为某段代码在应对未来需求变化的时候，能够做到“对扩展开放，对修改关闭”，但是有时候扩展和代码的复杂性又息息相关，增加代码的扩展性往往会增加代码的复杂度，使得代码更加难以解读。
我们有两点要注意。第一点是，开闭原则并不是说完全杜绝修改，而是以最小的修改代码的代价来完成新功能的开发。第二点是，同样的代码改动，在粗代码粒度下，可能被认定为“修改”；在细代码粒度下，可能又被认定为“扩展”。
## 2.如何做到“对扩展开放，对修改关闭“？
写代码的时候我们首先需要多花点时间来思考一下，这段代码在未来可能会有哪些需求变更，如何设计代码结构，以便事先留好扩展点，从而在未来需求变更的时候，在不改动代码整体结构的情况下，做到最小代码改动的情况下，将新的代码灵活的插入到扩展点上。
比如在Byteps的通信库的设计中，上层实现时不需要去考虑底层通信协议到底是TCP，还是RDMA，亦或是UCX。所以上层实现时通过定义一个抽象类，当底层具体通信协议实现时定义新的协议类继承该抽象类，从而实现如果出现一个新的协议，能够进一步写一个新的协议类来实现顶层的抽象类，从而做到对扩展开放，对修改关闭。


